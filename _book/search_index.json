[["index.html", "VHLSS Cleaning Procedure Preface", " VHLSS Cleaning Procedure Tuong-Vy Phan, Nguyen Thi Hong Tram &amp; Huy Le Vu 2025-12-23 Preface The Viet Nam Household Living Standards Survey (VHLSS) is one of the most comprehensive and widely used micro-datasets for socio-economic research in Viet Nam. However, because the survey has evolved significantly since its inception in 1993—with changes in sampling design, questionnaire structure, and variable naming—longitudinal analysis requires rigorous data cleaning and harmonization. The Purpose of this Book This documentation was developed by the Development and Policies Research Center (DEPOCEN) to serve as a standardized guide for researchers and data analysts. Our goal is to ensure that the data cleaning process is: Reproducible: All steps are scripted to ensure consistency. Transparent: Every decision regarding outliers, missing values, and variable merging is documented. Accessible: By centralizing metadata and harmonization crosswalks, we aim to reduce the “entry barrier” for new researchers using VHLSS. Who is this for? This guide is intended for economists, policy analysts, and students who are working with VHLSS microdata. We assume a basic understanding of statistical software (specifically Stata and R) and familiarity with household survey structures. Structure of the Documentation * Data Structure: An overview of the VHLSS history and sample design. * Cleaning Procedure: A step-by-step workflow for moving from raw files to a master harmonized dataset, with provided Stata code * Notes &amp; References: A collection of insights from the wider economic research community. Acknowledgements We would like to thank the General Statistics Office (GSO) for their work in conducting these surveys and the various scholars whose previous notes on VHLSS provided the foundation for this consolidated procedure. "],["overview.html", "Chapter 1 Overview Purpose Availability Survey period Coverage of the survey Data collection method", " Chapter 1 Overview Purpose To evaluate living standards for policy-making and socio-economic development planning, from 1993 to now the General Statistics Office (GSO) conducts the Viet Nam Household Living Standards Survey (VHLSS). The purpose of the VHLSS in order to systematically monitor and supervise the living standards of different population groups in Viet Nam; to monitor and evaluate the implementation of the Comprehensive Poverty Reduction and Growth Strategy; and to contribute to the evaluation of achievement of the Sustainable Development Goals (SDGs) and Vietnam’s socio-economic development goals. Availability From 2002 to 2010, this survey has been conducted regularly by the GSO every two years. From 2011 to 2022, VHLSS are conducted annually. However, the odd-numbered year surveys only collect data on demographics, employment and income. Survey period The survey was conducted in four periods in March, June, September and December. The period for collecting information in the locality is one month. The reference period of household income and expenditure was the last 12 months. Coverage of the survey Geographically, the survey covered the whole country. Scope of the survey included all selected enumeration areas and communes in 63 provinces and cities under central management. Data collection method Face-to-face interviews "],["data-structure.html", "Chapter 2 Data Structure 2.1 Outline of the survey 2.2 Sample Size 2.3 Basic Statistics", " Chapter 2 Data Structure 2.1 Outline of the survey Section 1. Basic demographic characteristics related to living standards Section 2. Education Section 3. Labour - Employment Section 4. Health and health care Section 5. Income Section 6. Consumption expenditure Section 7. Durable goods Section 8. Housing, electricity, water, sanitation facilities and use of Internet Section 9. Participation in poverty reduction programs Section 10. Business production activities Section 11. Commune general characteristics 2.2 Sample Size Sample Overview Sample size: 46,995 households Number of survey areas: 3,133 areas (selected from the master sample of the 2019 Population and Housing Census, updated as needed) The sample for the the year \\(t\\) Residential Living Standards Survey (KSMS \\(t\\)) was designed in 2 steps as follows: Step 1: Select Survey Areas Select 3,133 areas from the master sample, structured as follows: 25% (≈ 783 areas): Re-selected from areas surveyed only in KSMS \\(t-2\\) 25% (≈ 783 areas): Re-selected from areas surveyed in both KSMS \\(t-2\\) and KSMS \\(t-1\\) 25% (≈ 783 areas): Re-selected from areas surveyed only in KSMS \\(t-1\\) 25% (≈ 783 areas): Newly selected from the master sample Step 2: Select Households for Survey For areas re-selected from KSMS \\(t-1\\)/\\(t-2\\): Select all 15 households previously surveyed in \\(t-2\\) and/or \\(t-1\\) If a household is no longer in the area, a replacement household will be chosen Additionally select 5 reserve households from the reserve lists of previous years (if insufficient, select adjacent households) For newly selected areas: Update the list of all households in the area Select 20 households using the systematic random method from the updated list From these, select 15 main households and 5 reserve households 2.3 Basic Statistics Library library(tidyverse) library(gt) library(gtExtras) library(summarytools) library(haven) library(sjlabelled) library(webshot2) Import data vhlss &lt;- read_dta(&quot;clean/vhlss_14_18.dta&quot;) var_to_drop &lt;- c(&quot;tinh&quot;, &quot;huyen&quot;, &quot;xa&quot;, &quot;diaban&quot;, &quot;hoso&quot;, &quot;gioitinh&quot;, &quot;dantoc&quot;) Summary statistics source(&quot;script/gt_summarytools.R&quot;) vhlss &lt;- vhlss %&gt;% head(9399) %&gt;% select(where(is.numeric)) %&gt;% select(-any_of(var_to_drop)) %&gt;% mutate(across(everything(), ~ ifelse(.x &lt; 0, NA, .x))) %&gt;% copy_labels(vhlss) gt_summarytools(data = vhlss, title = &quot;VHLSS 2014-2018 Data Summary&quot;) @import url(\"https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\"); #bmiwtpdrnb table { font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; } #bmiwtpdrnb thead, #bmiwtpdrnb tbody, #bmiwtpdrnb tfoot, #bmiwtpdrnb tr, #bmiwtpdrnb td, #bmiwtpdrnb th { border-style: none; } #bmiwtpdrnb p { margin: 0; padding: 0; } #bmiwtpdrnb .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 3px; border-top-color: #FFFFFF; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #bmiwtpdrnb .gt_caption { padding-top: 4px; padding-bottom: 4px; } #bmiwtpdrnb .gt_title { color: #333333; font-size: 24px; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #bmiwtpdrnb .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #bmiwtpdrnb .gt_heading { background-color: #FFFFFF; text-align: left; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #bmiwtpdrnb .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #D3D3D3; } #bmiwtpdrnb .gt_col_headings { border-top-style: solid; border-top-width: 0px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #bmiwtpdrnb .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #bmiwtpdrnb .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #bmiwtpdrnb .gt_column_spanner_outer:first-child { padding-left: 0; } #bmiwtpdrnb .gt_column_spanner_outer:last-child { padding-right: 0; } #bmiwtpdrnb .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #bmiwtpdrnb .gt_spanner_row { border-bottom-style: hidden; } #bmiwtpdrnb .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #bmiwtpdrnb .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #bmiwtpdrnb .gt_from_md > :first-child { margin-top: 0; } #bmiwtpdrnb .gt_from_md > :last-child { margin-bottom: 0; } #bmiwtpdrnb .gt_row { padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #bmiwtpdrnb .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #bmiwtpdrnb .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #bmiwtpdrnb .gt_row_group_first td { border-top-width: 2px; } #bmiwtpdrnb .gt_row_group_first th { border-top-width: 2px; } #bmiwtpdrnb .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #bmiwtpdrnb .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #bmiwtpdrnb .gt_first_summary_row.thick { border-top-width: 2px; } #bmiwtpdrnb .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #bmiwtpdrnb .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #bmiwtpdrnb .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #bmiwtpdrnb .gt_last_grand_summary_row_top { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; } #bmiwtpdrnb .gt_striped { background-color: #FAFAFA; } #bmiwtpdrnb .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #bmiwtpdrnb .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #bmiwtpdrnb .gt_footnote { margin: 0px; font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #bmiwtpdrnb .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #bmiwtpdrnb .gt_sourcenote { font-size: 12px; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #bmiwtpdrnb .gt_left { text-align: left; } #bmiwtpdrnb .gt_center { text-align: center; } #bmiwtpdrnb .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #bmiwtpdrnb .gt_font_normal { font-weight: normal; } #bmiwtpdrnb .gt_font_bold { font-weight: bold; } #bmiwtpdrnb .gt_font_italic { font-style: italic; } #bmiwtpdrnb .gt_super { font-size: 65%; } #bmiwtpdrnb .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; } #bmiwtpdrnb .gt_asterisk { font-size: 100%; vertical-align: 0; } #bmiwtpdrnb .gt_indent_1 { text-indent: 5px; } #bmiwtpdrnb .gt_indent_2 { text-indent: 10px; } #bmiwtpdrnb .gt_indent_3 { text-indent: 15px; } #bmiwtpdrnb .gt_indent_4 { text-indent: 20px; } #bmiwtpdrnb .gt_indent_5 { text-indent: 25px; } #bmiwtpdrnb .katex-display { display: inline-flex !important; margin-bottom: 0.75em !important; } #bmiwtpdrnb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after { height: 0px !important; } VHLSS 2014-2018 Data Summary 9399 rows x 29 cols No Variable Variable_Name_Simple Type Stats / Values Freqs (% of Valid) Graph Valid Missing 1 tuoiTuổi tuoi numeric Mean (sd): 52.4 (13.7)min ≤ med ≤ max:19 ≤ 52 ≤ 101IQR (CV): 19 (0.3)82 distinct values – 19101 9399 (100%) 0 (0%) 2 khuvucThành thị/Nông thôn khuvuc numeric Mean (sd): 1.7 (0.5)min ≤ med ≤ max:1 ≤ 2 ≤ 2IQR (CV): 1 (0.3)2 distinct values – 12 9399 (100%) 0 (0%) 3 chi_giaoducTổng chi cho giáo dục chi_giaoduc numeric Mean (sd): 5698.9 (14215.1)min ≤ med ≤ max:0 ≤ 1087.5 ≤ 353480IQR (CV): 5195 (2.5)3183 distinct values – 0353K 9396 (100%) 3 (0%) 4 thu_giaoducTổng thu từ giáo dục qua học bổng, trợ cấp trong 12 tháng qua thu_giaoduc numeric Mean (sd): 446.4 (5841.1)min ≤ med ≤ max:0 ≤ 0 ≤ 402084IQR (CV): 0 (13.1)740 distinct values – 0402K 9396 (100%) 3 (0%) 5 khambenhTrong 12 tháng qua có thành viên hộ đến cơ sở y tế hoặc mời thầy thuốc không khambenh numeric Mean (sd): 1.2 (0.4)min ≤ med ≤ max:1 ≤ 1 ≤ 2IQR (CV): 0 (0.3)2 distinct values – 12 9399 (100%) 0 (0%) 6 ngoaitruChi phí khám chữa bệnh ngoại trú ngoaitru numeric Mean (sd): 2023.4 (7637)min ≤ med ≤ max:0 ≤ 210 ≤ 480000IQR (CV): 1480 (3.8)1070 distinct values – 0480K 9396 (100%) 3 (0%) 7 noitruChi phí khám chữa bệnh nội trú noitru numeric Mean (sd): 2709.3 (34325.4)min ≤ med ≤ max:0 ≤ 0 ≤ 3100000IQR (CV): 0 (12.7)450 distinct values – 03M 9396 (100%) 3 (0%) 8 chi_bhytChi phí mua bảo hiểm y tế chi_bhyt numeric Mean (sd): 877.4 (15343)min ≤ med ≤ max:0 ≤ 492 ≤ 1485000IQR (CV): 1200 (17.5)1081 distinct values – 01M 9396 (100%) 3 (0%) 9 thuocTiền thuốc thuoc numeric Mean (sd): 1268 (4465.1)min ≤ med ≤ max:0 ≤ 490 ≤ 3e+05IQR (CV): 790 (3.5)637 distinct values – 0300K 9396 (100%) 3 (0%) 10 dungcu_yteTiền mua dụng cụ y tế dungcu_yte numeric Mean (sd): 103.8 (635.8)min ≤ med ≤ max:0 ≤ 0 ≤ 50000IQR (CV): 90 (6.1)258 distinct values – 050K 9396 (100%) 3 (0%) 11 trocap_omTrợ giúp bằng tiền và hiện vật cho thành viên hộ bị ốm trocap_om numeric Mean (sd): 1139.2 (6766.7)min ≤ med ≤ max:0 ≤ 0 ≤ 243098IQR (CV): 0 (5.9)944 distinct values – 0243K 9396 (100%) 3 (0%) 12 chi_ytChi tiêu y tế chi_yt numeric Mean (sd): 6981.9 (39027.1)min ≤ med ≤ max:0 ≤ 2500 ≤ 3101262IQR (CV): 4760.5 (5.6)4493 distinct values – 03M 9396 (100%) 3 (0%) 13 thu_ytThu từ y tế thu_yt numeric Mean (sd): 1138.8 (6765.6)min ≤ med ≤ max:0 ≤ 0 ≤ 243098IQR (CV): 0 (5.9)944 distinct values – 0243K 9399 (100%) 0 (0%) 14 luong_1Tổng tiền công, tiền lương trong 12 tháng qua cho công việc 1 luong_1 numeric Mean (sd): 62751.7 (88317.5)min ≤ med ≤ max:0 ≤ 32010 ≤ 771531IQR (CV): 96000 (1.4)3246 distinct values – 0772K 9399 (100%) 0 (0%) 15 thuong_1Tiền lễ, tết, các khoản thưởng, phụ cấp cho công việc 1 thuong_1 numeric Mean (sd): 5860.8 (15658.8)min ≤ med ≤ max:0 ≤ 0 ≤ 356809IQR (CV): 4800 (2.7)2094 distinct values – 0357K 9399 (100%) 0 (0%) 16 luong_2Tổng tiền công, tiền lương trong 12 tháng qua cho công việc 2 luong_2 numeric Mean (sd): 2306.5 (11846.9)min ≤ med ≤ max:0 ≤ 0 ≤ 826560IQR (CV): 0 (5.1)787 distinct values – 0827K 9399 (100%) 0 (0%) 17 thuong_2Tiền lễ, tết, các khoản thưởng, phụ cấp cho công việc 2 thuong_2 numeric Mean (sd): 71.4 (1326.4)min ≤ med ≤ max:0 ≤ 0 ≤ 86100IQR (CV): 0 (18.6)169 distinct values – 086K 9399 (100%) 0 (0%) 18 thunhap_khacSố tiền nhận được từ công việc khác thunhap_khac numeric Mean (sd): 529.4 (4639.5)min ≤ med ≤ max:0 ≤ 0 ≤ 357522IQR (CV): 0 (8.8)370 distinct values – 0358K 9399 (100%) 0 (0%) 19 trocap_thatnghiepTổng thu nhập từ trợ cấp thất nghiêp, trợ cấp thôi việc, lương cho nghỉ hưu, lươ trocap_thatnghiep numeric Mean (sd): 7233.6 (26931.9)min ≤ med ≤ max:0 ≤ 0 ≤ 324330IQR (CV): 0 (3.7)757 distinct values – 0324K 9399 (100%) 0 (0%) 20 tongthunhapTổng tất cả thu nhập = M4ATN1+M4ATN2+M4ATN3+M4ATN4+M4ATN5+M4ATN6 tongthunhap numeric Mean (sd): 78753.4 (105660.8)min ≤ med ≤ max:0 ≤ 46000 ≤ 978697IQR (CV): 112895 (1.3)4919 distinct values – 0979K 9399 (100%) 0 (0%) 21 tongthuTổng thu nhập tongthu numeric Mean (sd): 240456.1 (683678.2)min ≤ med ≤ max:5095 ≤ 144260 ≤ 52319795IQR (CV): 179424.5 (2.8)8889 distinct values – 5K52M 9399 (100%) 0 (0%) 22 thu_chiphiThu nhập từ các khoản chi phí thu_chiphi numeric Mean (sd): 162048.4 (153585.2)min ≤ med ≤ max:5095 ≤ 121170 ≤ 1794642IQR (CV): 141822 (0.9)8969 distinct values – 5K2M 9397 (100%) 2 (0%) 23 tnbqdnThu nhập bình quân/người/tháng tnbqdn numeric Mean (sd): 3854.1 (3529.6)min ≤ med ≤ max:246 ≤ 2887 ≤ 63295IQR (CV): 2984 (0.9)5218 distinct values – 24663K 9397 (100%) 2 (0%) 24 tongchiTổng chi tiêu tongchi numeric Mean (sd): 214365.5 (1292136.7)min ≤ med ≤ max:0 ≤ 73781 ≤ 105193560IQR (CV): 116163 (6)9221 distinct values – 0105M 9399 (100%) 0 (0%) 25 yearNo label available year numeric Mean (sd): 2018 (0)min ≤ med ≤ max:2016 ≤ 2018 ≤ 2018IQR (CV): 0 (0)2 distinct values – 2.016K2.018K 9399 (100%) 0 (0%) 26 sonhaNo label available sonha logical [1] NA 9399 (100%) Insufficient valid data for plot (N 0 (0%) 9399 (100%) 27 dientichNo label available dientich logical [1] NA 9399 (100%) Insufficient valid data for plot (N 0 (0%) 9399 (100%) 28 thuenhaNo label available thuenha logical [1] NA 9399 (100%) Insufficient valid data for plot (N 0 (0%) 9399 (100%) 29 thu_khacNo label available thu_khac logical [1] NA 9399 (100%) Insufficient valid data for plot (N 0 (0%) 9399 (100%) "],["cleaning-procedure.html", "Chapter 3 Cleaning Procedure 3.1 Clear all settings 3.2 Set Working Directory 3.3 Clean data for each year 3.4 Create panal data", " Chapter 3 Cleaning Procedure Below is the code used to clean VHLSS 2014 to 2018 at household level 3.1 Clear all settings cap log close clear all clear matrix set more off eststo clear 3.2 Set Working Directory Replace username and path to your folder if &quot;`c(username)&#39;&quot; == &quot;XXX&quot; { gl MyProject &quot;/Users/XXX/My Drive/DEPOCEN - VHLSS Data cleaning&quot; gl data &quot;$MyProject/data&quot; gl clean &quot;$MyProject/clean&quot; gl temp &quot;$MyProject/temp&quot; } 3.3 Clean data for each year 3.3.1 Make sure each file is uniquely defined forval i = 14 (2) 18 { foreach m in Ho1 Ho2 Ho3 Ho4 { use &quot;$data/VHLSS_20`i&#39;/hhold/`m&#39;.dta&quot;, clear duplicates drop tinh huyen xa diaban hoso, force tempfile uniq_`m&#39;_20`i&#39; save `uniq_`m&#39;_20`i&#39;&#39;, replace } } 3.3.2 Merge household file forval i = 14 (2) 18 { use `uniq_Ho1_20`i&#39;&#39;, clear merge 1:1 tinh huyen xa diaban hoso using `uniq_Ho2_20`i&#39;&#39; drop _merge merge 1:1 tinh huyen xa diaban hoso using `uniq_Ho3_20`i&#39;&#39; drop _merge merge 1:1 tinh huyen xa diaban hoso using `uniq_Ho4_20`i&#39;&#39; drop _merge save &quot;$temp/ho_20`i&#39;.dta&quot;, replace } 3.3.3 Generate variables forval i = 14 (2) 18 { use &quot;$data/VHLSS_20`i&#39;/hhold/Muc1A.dta&quot;, clear keep if m1ac3 == 1 // keep if that individual is household head keep tinh huyen xa diaban hoso m1ac2 m1ac5 duplicates drop tinh huyen xa diaban hoso, force // Gender of household head merge 1:1 tinh huyen xa diaban hoso using &quot;$temp/ho_20`i&#39;.dta&quot; keep if _m == 3 drop _m // Total expenditure egen tongchi_01 = rowtotal(chisxkd_1 chisxkd_2 chisxkd_3 chisxkd_4 chisxkd_5 chisxkd_6 chisxkd_7 chisxkd_8 chikhac_1 chikhac_2 chikhac_3 chikhac_4 chikhac_5 chikhac_6 chikhac_7 chikhac_8 chikhac_9) save &quot;$temp/ho_20`i&#39;.dta&quot;, replace } 3.3.4 Take variables from individual file These variables do not have in household file, so we need to take them from individual file use &quot;$data/VHLSS_2014/hhold/Muc3C.dta&quot;, clear collapse (sum) m3c11 m3c13 m3c14 m3c15, by(tinh huyen xa diaban hoso) merge 1:1 tinh huyen xa diaban hoso using &quot;$temp/ho_2014.dta&quot; drop _m save &quot;$temp/ho_2014.dta&quot;, replace use &quot;$data/VHLSS_2014/hhold/Muc3B.dta&quot;, clear collapse (sum) m3c5b m3c6b, by(tinh huyen xa diaban hoso) merge 1:1 tinh huyen xa diaban hoso using &quot;$temp/ho_2014.dta&quot; drop _m save &quot;$temp/ho_2014.dta&quot;, replace use &quot;$data/VHLSS_2014/hhold/Muc7.dta&quot;, clear keep tinh huyen xa diaban hoso m7c1 m7c2 m7c8 m7c17 merge 1:1 tinh huyen xa diaban hoso using &quot;$temp/ho_2014.dta&quot; drop _m save &quot;$temp/ho_2014.dta&quot;, replace 3.4 Create panal data 3.4.1 Import the meta data Since same variable can have different name in each year, we need to change them into 1 name to append together. This metadata will be used to rename, keep and label all wanted variables. import delimited &quot;$data/VHLSS_codebook_9k - ho.csv&quot;, varnames(1) encoding(UTF-8) clear 3.4.2 Rename and label code local N = _N forval i = 2014 (2) 2018 { // Open file to write file open myfile using `&quot;$temp/label`i&#39;.do&quot;&#39;, write text replace local renamed_vars &quot;&quot; forval iii = 1/`N&#39; { local vvvcode = code[`iii&#39;] local vvv_i = code_`i&#39;[`iii&#39;] // Chuyển từ vvv`i&#39; thành vvv_i để tránh lỗi cú pháp local v_desc = description[`iii&#39;] // Check if code_`i&#39; is not empty if `&quot;`vvv_i&#39;&quot;&#39; != &quot;&quot; { // Create the Rename command local result = `&quot;ren `vvv_i&#39; `vvvcode&#39;&quot;&#39; file write myfile `&quot;`result&#39;&quot;&#39; _n // Create the Label command local lab_cmd `&quot;label variable `vvvcode&#39; `&quot;`v_desc&#39;&quot;&#39;&quot;&#39; file write myfile `&quot;`lab_cmd&#39;&quot;&#39; _n local renamed_vars &quot;`renamed_vars&#39; `vvvcode&#39;&quot; } } file write myfile `&quot;keep`renamed_vars&#39;&quot;&#39; // Close file file close myfile } clear tempfile combined_data save `combined_data&#39;, emptyok forval i = 2014 (2) 2018 { // Use file corresponding to each year use &quot;$temp/ho_`i&#39;.dta&quot;, clear // Run file .do corresponding to each year do `&quot;$temp/label`i&#39;.do&quot;&#39; gen year = `i&#39; // Append data to initially created file append using `combined_data&#39; save `combined_data&#39;, replace } save &quot;$clean/vhlss_14_18.dta&quot;, replace "],["important-note-during-cleaning.html", "Chapter 4 Important note during cleaning 4.1 Linking VHLSSs 4.2 Inconsistent province codes 4.3 Inconsistent industry codes 4.4 Weight Data", " Chapter 4 Important note during cleaning 4.1 Linking VHLSSs VHLSS is a rotating panel dataset. It is possible to construct a panel across three survey rounds (e.g., 2014-2016-2018) if the data is designed based on the same Population and Housing Census. For instance, the household system from 2010 to 2018 was designed from the 2009–2010 Census. However, because VHLSS 2020 was designed based on the 2019 Census, it is not possible to create a panel linking VHLSS 2016–2018 with 2020. 4.2 Inconsistent province codes As many users of Vietnamese data know, the number of provinces has changed significantly since the late 1980s. In most cases the changing of provincial boundaries was either a splitting or aggregating of existing provinces as opposed to districts being reallocated between provinces. The province codes also change within surveys and across data sources. 4.3 Inconsistent industry codes VSIC1993 is the basis of industry codes used in the 2002 through 2006 VHLSSs, the 2000 through 2007 enterprise data, and the 1999 population census. VSIC2007 is used in the 2008 through 2018 VHLSSs, the 2008 through 2017 enterprise data, and the 2009 population census. VSIC2018 is used in the 2019 population census. 4.4 Weight Data At household level, each VHLSS will have a weihgt data for each year. Usually we would use \\(wt9\\), which is the weight of 9,000 household. There are also \\(wt36\\) and \\(wt45\\) is for file with 36,000 or 45,000 household. At individual level, we need to take the weight divided by the number of family member. \\(\\text{Weight individual} = \\frac{\\text{Weight household}}{\\text{Houshold size}}\\) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
